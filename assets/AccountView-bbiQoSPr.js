import{N as P,D}from"./NavbarBackend-8Zfg4MvJ.js";import{_ as w,o as d,c as m,d as t,a as l,w as g,b as x,n as v,r as c,k as u,v as p,x as S,F as _,e as V,t as N}from"./index-8L-AmbAE.js";import{N as C,_ as I}from"./NavbarEl-oruzAsEM.js";const T={methods:{isActive(r){return this.$route.name===r}}},U={class:"max-w-screen-lg mx-auto pt-4 pb-2 px-3"},A={class:"flex p-1 justify-center"},F={class:"relative"},B={class:"relative"},j={class:"relative"};function z(r,e,s,b,o,n){const i=c("router-link");return d(),m("div",U,[t("ul",A,[t("li",F,[l(i,{to:{name:"Vote"},class:v(["bg-white border border-gray-4 border-r-0 rounded-s-3xl block px-3 md:px-6 py-3 font-medium hover:text-primary hover:after:absolute hover:after:rounded hover:after:left-2 md:hover:after:left-4 hover:after:inset-y-4 hover:after:-translate-x-1 hover:after:w-1 hover:after:h-5 hover:after:bg-primary",[n.isActive("Vote")?"after:absolute after:rounded after:left-2 md:after:left-4 after:inset-y-4 after:-translate-x-1 after:w-1 after:h-5 after:bg-primary text-primary":""]])},{default:g(()=>[x(" 發起投票 ")]),_:1},8,["class"])]),t("li",B,[l(i,{to:{name:""},class:v(["bg-white border border-t-gray-4 border-b-gray-4 border-x-0 block px-3 md:px-6 py-3 font-medium hover:text-primary hover:after:absolute hover:after:rounded hover:after:left-2 md:hover:after:left-4 hover:after:inset-y-4 hover:after:-translate-x-1 hover:after:w-1 hover:after:h-5 hover:after:bg-primary",[n.isActive("")?"after:absolute after:rounded after:left-2 md:after:left-4 after:inset-y-4 after:-translate-x-1 after:w-1 after:h-5 after:bg-primary text-primary":""]])},{default:g(()=>[x(" 投票紀錄 ")]),_:1},8,["class"])]),t("li",j,[l(i,{to:{name:""},class:v(["bg-white border border-gray-4 border-l-0 rounded-e-3xl block px-3 md:px-6 py-3 font-medium hover:text-primary hover:after:absolute hover:after:rounded hover:after:left-2 md:hover:after:left-4 hover:after:inset-y-4 hover:after:-translate-x-1 hover:after:w-1 hover:after:h-5 hover:after:bg-primary",[n.isActive("")?"after:absolute after:rounded after:left-2 md:after:left-4 after:inset-y-4 after:-translate-x-1 after:w-1 after:h-5 after:bg-primary text-primary":""]])},{default:g(()=>[x(" 投票留言 ")]),_:1},8,["class"])])])])}const Y=w(T,[["render",z]]),E={components:{Navbar:C,NavbarBackend:P,NavbarVote:Y,ComponentFooter:I,DelModal:D},data(){return{delContent:"「此帳號後，需重新建立帳號」",memberId:"",memberPerson:{follwing:[],followers:[],socialMedia:[],likedPolls:[]},birthday:""}},methods:{getToken(){const r=document.cookie.replace(/(?:(?:^|.*;\s*)selectWaveToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=r,this.$http.get("https://select-wave-backend.onrender.com/api/auth/check",{headers:{Authorization:r}}).then(s=>{if(s.data.status){console.log(s);const{id:b}=s.data.result;this.memberId=b,this.getMemberInfo(this.memberId)}else this.$swal({title:"登入失敗，請重新登入"}),this.$router.push("/login")}).catch(s=>{this.$swal({title:`${s.response.data.message}`})})},getMemberInfo(r){const e=`https://select-wave-backend.onrender.com/api/member/${r}`;this.$http.get(e).then(s=>{this.memberPerson=s.data.result,this.memberPerson.socialMedia.length||this.memberPerson.socialMedia.push({type:"Facebook",id:""},{type:"Instagram",id:""},{type:"YouTube",id:""},{type:"個人網站",id:""}),console.log(this.memberPerson)}).catch(s=>{console.log(s),this.$swal({title:`${s.response.data.message}`})})},updateMember(){this.$http.put("https://select-wave-backend.onrender.com/api/member/",this.memberPerson).then(e=>{console.log(e),this.getMemberInfo(this.memberId),this.$swal({title:`${e.data.message}`})}).catch(e=>{console.log(e),this.$swal({title:`${e.response.data.message}`})})},clickDate(){if(this.birthday){const r=new Date(this.birthday),e=r.getFullYear(),s=String(r.getMonth()+1).padStart(2,"0"),b=String(r.getDate()).padStart(2,"0"),o=String(r.getHours()).padStart(2,"0"),n=String(r.getMinutes()).padStart(2,"0"),i=String(r.getSeconds()).padStart(2,"0"),h=String(r.getMilliseconds()).padStart(3,"0"),y=`${e}-${s}-${b}T${o}:${n}:${i}.${h}Z`;this.memberPerson.birthday=y}}},watch:{memberPerson:{handler(){[this.birthday]=this.memberPerson.birthday.split("T")},deep:!0}},mounted(){this.getToken()}},H={class:"max-w-screen-lg mx-auto px-3"},L={class:"outline outline-1 outline-gray-3 rounded-2xl md:rounded-3xl py-11 px-5 mb-10"},W={class:"flex justify-between mb-7 md:mb-8 max-w-3xl mx-auto"},Z=t("button",{type:"button",class:"px-6 py-3 flex items-center justify-center rounded-full bg-white text-gray-1 text-base font-medium outline outline-2 outline-gray-1 hover:outline-primary hover:text-primary"}," 換成頭像 ",-1),q={class:"mb-4"},G=t("label",{for:"name",class:"block mb-2 text-base font-medium text-gray-1"},"名稱",-1),J={class:"mb-4"},K=t("label",{for:"sex",class:"block mb-2 text-base font-medium text-gray-1"},"性別",-1),O=t("option",{value:"",selected:"",disabled:""},"請選擇性別",-1),Q=t("option",{value:"male"},"男",-1),R=t("option",{value:"female"},"女",-1),X=t("option",{value:"x"},"不方便透露",-1),ee=[O,Q,R,X],te={class:"mb-4"},re=t("label",{for:"birthday",class:"block mb-2 text-base font-medium text-gray-1"},"生日",-1),oe={for:"facebookUrl",class:"block mb-2 text-base font-medium text-gray-1"},ae=["onUpdate:modelValue"],se=t("button",{type:"submit",class:"text-white bg-gray-1 hover:bg-primary focus:ring-4 focus:outline-none focus:ring-primary-light font-medium rounded-full text-base w-full sm:w-auto px-5 py-2.5 text-center"}," 更新 ",-1);function ne(r,e,s,b,o,n){const i=c("Navbar"),h=c("NavbarBackend"),y=c("NavbarVote"),k=c("DelModal"),M=c("ComponentFooter");return d(),m(_,null,[l(i),l(h),l(y),t("div",H,[t("div",L,[t("div",W,[Z,t("button",{type:"button",class:"px-6 py-3 flex items-center justify-center rounded-full border-2 border-gray-1 bg-white text-gray-1 text-base font-medium hover:text-primary hover:border-primary",onClick:e[0]||(e[0]=a=>r.$refs.DelModal.openModal())}," 刪除帳號 ")]),t("form",{class:"max-w-3xl mx-auto",onSubmit:e[7]||(e[7]=(...a)=>n.updateMember&&n.updateMember(...a))},[t("div",q,[G,u(t("input",{type:"text",id:"name",class:"bg-white border border-gray-3 text-sm rounded-full focus:ring-primary focus:border-primary block w-full px-3 py-4","onUpdate:modelValue":e[1]||(e[1]=a=>o.memberPerson.name=a)},null,512),[[p,o.memberPerson.name]])]),t("div",J,[K,u(t("select",{id:"sex",class:"bg-white border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-primary focus:border-primary block w-full px-3 py-4","onUpdate:modelValue":e[2]||(e[2]=a=>o.memberPerson.gender=a)},ee,512),[[S,o.memberPerson.gender]])]),t("div",te,[re,o.memberPerson.birthday?u((d(),m("input",{key:1,type:"date",id:"birthday",class:"bg-white border border-gray-3 text-sm rounded-full focus:ring-primary focus:border-primary block w-full px-3 py-4","onUpdate:modelValue":e[5]||(e[5]=a=>o.birthday=a),onInput:e[6]||(e[6]=(...a)=>n.clickDate&&n.clickDate(...a))},null,544)),[[p,o.birthday]]):u((d(),m("input",{key:0,type:"date",id:"birthday",class:"bg-white border border-gray-3 text-sm rounded-full focus:ring-primary focus:border-primary block w-full px-3 py-4","onUpdate:modelValue":e[3]||(e[3]=a=>o.birthday=a),onInput:e[4]||(e[4]=(...a)=>n.clickDate&&n.clickDate(...a))},null,544)),[[p,o.birthday]])]),(d(!0),m(_,null,V(o.memberPerson.socialMedia,(a,f)=>(d(),m("div",{class:"mb-4",key:f},[t("label",oe,N(o.memberPerson.socialMedia[f].type)+" 社群連結 ",1),u(t("input",{type:"url",class:"bg-white border border-gray-3 text-sm rounded-full focus:ring-primary focus:border-primary block w-full px-3 py-4 mb-2",placeholder:"請填入社群網址","onUpdate:modelValue":$=>o.memberPerson.socialMedia[f].id=$},null,8,ae),[[p,o.memberPerson.socialMedia[f].id]])]))),128)),se],32)])]),l(k,{ref:"DelModal",delContent:o.delContent},null,8,["delContent"]),l(M)],64)}const me=w(E,[["render",ne]]);export{me as default};
